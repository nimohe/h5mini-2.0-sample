# Construct 2引擎游戏API使用说明

当前案例使用的是Construct 2 r255版本进行开发。

#### 目录结构描述

	|--construct2                       // Construct 2案例
	   |--h5api                            // 4399API库
	   |--h5api.c2addon                    // 4399API库打包的组件
	   |--construct 2.capx     			   // 使用案例
	   |--README.md                        // 本说明文档

## API添加步骤

### 1. 安装API组件

> 拖拽`h5api.c2addon`文件到你的Construct 2编辑器中，并点击`Install`进行组件安装。

> 重启Construct 2编辑器。

> ![组件安装示例。](https://i.imgur.com/gb4xKFQ.jpg)

### 2. 添加API组件

> 在你的游戏场景中右键选择`Insert new object`，选择Platform specific列表下的`H5API`组件，添加到你的游戏场景中。

> H5API组件只能添加一次。

>![添加4399API组件](https://i.imgur.com/1FHkmWX.png)

### 3. 游戏使用API

请参考案例使用

在进行后续操作前都应调用对应的方法，调用后会更改相关的条件为true，此时会自动使用runtime.trigger()触发一次对应事件，可在API源码查看。

在示例中能看到`方法` + `complete`和`方法` + `code`结尾的条件，`complete`结尾的条件是指`方法`已经顺利执行，但是有一些方法返回的值还需要自己判断来进行下一步操作。

可以根据`code`来判断，`code`的取值会在下面介绍。示例中已经示范了全部API的方法，调用某些方法后会有一些表达式供使用，也会在下面介绍。

在开发中可以点击具体的API查看详细描述。

#### 2.1.广告API

##### -是否可以播放广告及获取剩余次数

> 返回boolean值，true为有广告资源可以播放，false为无法播放广告。

- 表达式
	adRemain：可播放广告剩余次数


##### -播放全屏广告

> 播放全屏广告，并获得广告播放状态。

- code
	10000：开始播放
	10001：播放结束
	10003：广告异常或没有广告可播放

- 表达式
	adState：广告播放状态

#### 2.2.分享API

##### -调用分享

> 触发分享功能，将游戏地址分享给好友。

	h5api.share()

##### -是否登录

> 判断当前玩家是否已登录。

- 表达式
	isLogin：是否登录

##### -打开用户登录面板

> 没登录就打开登录面板，有登录就返回用户信息

- 表达式
	uId：用户编号
	userName：用户昵称

#### -根据用户编号获得用户头像地址

> 需要传入用户编号，头像大小有三种尺寸

- 参数
	编号：输入用户编号

- 表达式
	userAvatar：用户头像地址

#### 2.3.积分排行榜API

##### -展示排行榜列表面板

> 直接调用即可


##### -提交玩家分数到排行榜

> 限制最高50万分

- 参数
	分数：玩家分数

- code
	10000：提交成功
	10001：为提交失败

- 表达式 
	historyRank：提交玩家分数到排行榜成功后返回历史最好排名
	historyScore：提交玩家分数到排行榜成功后返回历史最好分数

##### -获得排行榜排名列表

> 开发者需要根据自身游戏需求设计相应的排行榜排名列表

- 参数
	页码：页码，从1开始（选填，默认为1）
	每页条数：每页条数（选填，默认为10）

- code
	10000：提交成功
	10001：为提交失败

- 表达式 
	rankingList：排行榜排名列表，为c2array形式的字符串

##### -获取当前玩家的排名

> 获取当前玩家的排名

- code
	10000：提交成功
	10001：为提交失败

- 表达式
	myRanking：当前玩家的排名

##### -获得我排名附近的排名列表

> 获得我排名附近的排名列表

- 参数
	需要条数：需要条数（选填，默认为10）

- code
	10000：提交成功
	10001：为提交失败

- nearRanking：玩家排名附近的排名列表，为c2array形式的字符串

## 其它

> API使用请参考官方文档的原生js使用： http://www.4399api.com/res/h5mini/api